{% extends 'base.html.twig' %}

{% block title %}
    Paramètres de la compétition
{% endblock %}

{% block body %}
<div class="min-h-screen w-screen bg-[#9ECFC2]">
    <div class="min-h-screen w-screen bg-black/10 flex items-center justify-center">
        <div class="w-full max-w-4xl px-6 py-10">

            <div class="mb-8 flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-slate-900">Paramètres du Tournoi</h1>
                    <p class="mt-1 text-sm text-slate-700/80">
                        Configuration de la phase finale
                    </p>
                </div>

                <span class="inline-flex items-center rounded-full bg-white/70 px-3 py-1 text-xs font-semibold text-slate-700 ring-1 ring-black/5">
                    ID : {{ competition.id }}
                </span>
            </div>

            <section class="rounded-2xl bg-white/90 p-6 shadow-lg ring-1 ring-black/5 backdrop-blur mb-8">
                <div class="flex items-start justify-between gap-4">
                    <h2 class="text-lg font-semibold text-slate-900">
                        Phase finale
                    </h2>

                    <div class="grid h-10 w-10 place-items-center rounded-2xl bg-emerald-600/15 text-emerald-800 ring-1 ring-emerald-600/20">
                        ⚙
                    </div>
                </div>

                <form action="{{ path('app_competition_mise_a_jour_bracket', {'competitionId': competition.id}) }}"
                      method="post"
                      class="mt-6 grid grid-cols-1 gap-5">

                    <div>
                        <label class="text-xs font-semibold tracking-wide text-slate-700">
                            Nombre d'équipes en phase finale
                        </label>
                        <select name="nbEquipesMax"
                                class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 shadow-sm outline-none
                                       focus:border-emerald-600 focus:ring-4 focus:ring-emerald-600/15">
                            <option value="0" {{ nbEquipesMaxBracket == 0 ? 'selected' : '' }}>Aucun (Championnat simple)</option>
                            <option value="4" {{ nbEquipesMaxBracket == 4 ? 'selected' : '' }}>4 (Demi-finales)</option>
                            <option value="8" {{ nbEquipesMaxBracket == 8 ? 'selected' : '' }}>8 (Quarts)</option>
                            <option value="16" {{ nbEquipesMaxBracket == 16 ? 'selected' : '' }}>16 (Huitièmes)</option>
                            <option value="32" {{ nbEquipesMaxBracket == 32 ? 'selected' : '' }}>32 (Seizièmes)</option>
                        </select>
                    </div>

                    <div class="flex items-center gap-2">
                        <input type="checkbox"
                               id="petiteFinale"
                               name="petiteFinale"
                               {{ petiteFinale ? 'checked' : '' }}
                               class="h-4 w-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500">
                        <label for="petiteFinale" class="text-sm text-slate-700">
                            Inclure une petite finale (3ᵉ place)
                        </label>
                    </div>

                    <div class="flex justify-end">
                        <button type="submit"
                                class="inline-flex items-center justify-center rounded-xl bg-emerald-600 px-6 py-3 text-sm font-semibold text-white
                                       hover:bg-emerald-700 focus:outline-none focus:ring-4 focus:ring-emerald-600/30">
                            Enregistrer la configuration
                        </button>
                    </div>
                </form>
            </section>

            <section class="rounded-2xl bg-white/90 p-6 shadow-lg ring-1 ring-black/5 backdrop-blur">
                <h2 class="text-lg font-semibold text-red-700 mb-4">
                    Actions sur les matchs
                </h2>

                {% if nbEquipesMaxBracket > 0 %}
                    <a href="{{ path('app_matchs_generer_arbre_init', {'competitionId': competition.id}) }}"
                       onclick="return confirm('Attention : cela va supprimer les matchs existants de phase finale. Continuer ?');"
                       class="mb-4 inline-flex w-full items-center justify-center rounded-xl bg-red-600 px-6 py-3 text-sm font-semibold text-white
                              hover:bg-red-700 focus:outline-none focus:ring-4 focus:ring-red-600/30">
                        Générer l'arbre de phase finale
                    </a>
                {% else %}
                    <div class="rounded-xl bg-yellow-50 p-4 text-sm text-yellow-800 ring-1 ring-yellow-400/30 mb-4">
                        Veuillez d'abord configurer le nombre d'équipes pour la phase finale.
                    </div>
                {% endif %}

                <a href="{{ path('app_matchs', {'competitionId': competition.id}) }}"
                   class="inline-flex w-full items-center justify-center rounded-xl bg-slate-100 px-6 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-200">
                    Retour aux matchs
                </a>
            </section>

        </div>
    </div>
</div>
{% endblock %}
