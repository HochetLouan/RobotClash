{% extends 'base.html.twig' %}

{% block title %}{{ 'match_comment.title'|trans }}
{% endblock %}


{% block body %}
	<div class="min-h-screen w-screen bg-cover bg-center bg-no-repeat" style="background-image: url('{{ asset('/images/FondEdit.svg') }}');">
		<div class="min-h-screen w-screen bg-black/15">
			<h1 class="text-2xl text-white  font-bold mb-6">{{ 'match_comment.heading'|trans }}</h1>


			{% if is_granted('ROLE_ORGANISATEUR') %}

				{% if matchs is empty %}
					<div class="mx-auto max-w-xl rounded-2xl bg-white/85 p-8 text-center shadow-lg ring-1 ring-black/5 backdrop-blur">
						<div class="mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-emerald-600/10 text-emerald-700 ring-1 ring-emerald-600/20">
							<svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6l4 2"/>
							</svg>
						</div>
						<p class="mt-4 text-lg font-semibold text-slate-900">{{ 'match_comment.empty.title'|trans }}</p>
						<p class="mt-2 text-sm text-slate-600">
							{{ 'match_comment.empty.subtitle'|trans }}
						</p>
					</div>
				{% endif %}


				<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">

					{% for match in matchs %}
						{% if match.statusA == 1 and match.statusB == 1 %}

							<div class="group relative overflow-hidden rounded-2xl bg-white/90 shadow-lg ring-1 ring-black/5 backdrop-blur">


								<div class="h-1.5 w-full bg-emerald-500/80"></div>

								<div class="p-5">


									<div class="flex items-center justify-between">
										<div class="text-xs font-semibold text-slate-600">
											{{ 'match_comment.card.match_label'|trans }}
										</div>


										<div class="inline-flex items-center rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold text-slate-700">
											{{ 'match_comment.card.vs'|trans }}
										</div>
									</div>


									<div
										class="mt-4 grid grid-cols-[1fr_auto_1fr] items-center gap-3">

										<div class="flex flex-col items-center text-center">
											<img class="h-16 w-16 rounded-full bg-white ring-1 ring-black/10 p-1 shadow-sm" src="https://api.dicebear.com/9.x/avataaars-neutral/svg?seed={{ match.equipeA }}" alt="Avatar de {{ match.equipeA }}" loading="lazy"/>
											<div class="mt-2 w-full truncate text-sm font-semibold text-slate-900">
												{{ match.equipeA }}
											</div>
											<div class="text-xs text-slate-500 rounded-full bg-green-400 p-2 ">{{ 'match_comment.card.team_green'|trans }}</div>
										</div>

										<div class="flex flex-col items-center">
											<div class="relative">
												<img class="h-10 w-10" src="{{ asset('images/IconBataille.png') }}" alt="Versus"/>
												<div class="pointer-events-none absolute 
 -inset-2 rounded-full bg-emerald-500/10 blur-md opacity-0 group-hover:opacity-100 transition"></div>
											</div>
											<div class="mt-1 text-xs font-semibold text-slate-700">{{ 'match_comment.card.vs'|trans }}</div>
										</div>

										<div class="flex flex-col items-center text-center">
											<img class="h-16 w-16 rounded-full bg-white ring-1 ring-black/10 p-1 shadow-sm" src="https://api.dicebear.com/9.x/avataaars-neutral/svg?seed={{ match.equipeB }}" alt="Avatar de {{ match.equipeB }}" loading="lazy"/>
											<div class="mt-2 w-full truncate text-sm font-semibold text-slate-900">
												{{ match.equipeB }}
											</div>
											<div class="text-xs text-slate-500 rounded-full bg-sky-400 p-2 ">{{ 'match_comment.card.team_blue'|trans }}</div>
										</div>

									</div>

									<div class="my-4 h-px w-full bg-gradient-to-r from-transparent via-slate-900/10 to-transparent"></div>


									<div class="flex items-start gap-3 w-full rounded-2xl bg-white/80 p-4 ring-1 ring-black/5 backdrop-blur">


										<div class="mt-0.5 flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-emerald-600/10 text-emerald-700">
											<svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke="currentColor">
												<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h6m-6 4h10M5 6a2 2 0 0 1 2-2h10a2 2 0 0 1 
 2 2v12l-4-3H7a2 2 0 0 1-2-2V6z"/>
											</svg>
										</div>

										<div class="flex-1">
											<div class="text-xs font-semibold uppercase tracking-wide text-slate-500">
												{{ 'match_comment.card.comment_title'|trans }}
											</div>

											{% if match.commentaire is empty %}
												<p class="mt-1 text-sm text-slate-500 italic">
													{{ 'match_comment.card.no_comment'|trans }}
 </p>
											{% else %}
												<p class="mt-1 text-sm text-slate-900 leading-relaxed whitespace-pre-line">
													{{ match.commentaire }}
												</p>
											{% endif %}
										</div>

									</div>


									<div class="my-4 h-px w-full bg-gradient-to-r from-transparent via-slate-900/10 to-transparent"></div>


									<div class="flex gap-2">

										<button data-modal-target="comm-{{ match.id }}" data-modal-toggle="comm-{{ match.id }}" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-emerald-600 px-4 py-3 text-sm font-semibold text-white
																																												                   hover:bg-emerald-700 focus:outline-none focus:ring-4 focus:ring-emerald-600/20 transition" type="button">
											<svg class="h-5 w-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24">
												<path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 
 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"/>
											</svg>
											{{ match.commentaire is empty ? 'match_comment.button.add'|trans : 'match_comment.button.edit'|trans }}
										</button>
									</div>
								</div>
							</div>


							<div id="comm-{{ match.id }}" tabindex="-1" aria-hidden="true" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm p-4">
								<div class="relative w-full max-w-lg">
									<div
										class="rounded-2xl bg-white shadow-xl ring-1 ring-black/5 overflow-hidden">

										<div class="flex items-start justify-between p-5 border-b">
											<div>
												<h3 class="text-lg font-semibold text-slate-900">{{ 'match_comment.modal.title'|trans }}</h3>
											</div>

											<button type="button" data-modal-hide="comm-{{ match.id }}" class="h-9 w-9 rounded-lg hover:bg-slate-100 text-slate-700 flex items-center justify-center" aria-label="Fermer">
												✕
											</button>
										</div>

										<form method="post" action="{{ path('app_comm_maj', { id: match.id }) }}" class="p-5">

											<label for="commentaire-{{ match.id }}" class="block text-sm font-semibold text-slate-800">
												{{ 'match_comment.modal.label'|trans }}
											</label>

											<textarea id="commentaire-{{ match.id }}" name="commentaire" rows="4" maxlength="32" class="mt-2 w-full rounded-2xl border-slate-200 bg-white px-4 py-3 text-sm text-slate-900
																																																               
   shadow-sm focus:border-emerald-500 focus:ring-emerald-500" placeholder="{{ 'match_comment.modal.placeholder'|trans }}">{{ match.commentaire }}</textarea>

											<div class="mt-2 flex items-center justify-between">
												<p class="text-xs text-slate-500">
													{{ 'match_comment.modal.tip'|trans }}
 </p>
												<button type="button" class="text-xs font-semibold text-slate-600 hover:text-slate-900 underline" onclick="document.getElementById('commentaire-{{ match.id }}').value=''">
													{{ 'match_comment.modal.clear'|trans }}
												</button>
											</div>

											<div class="mt-5 flex flex-col-reverse gap-2 sm:flex-row sm:justify-end">
												<button type="button" data-modal-hide="comm-{{ match.id }}" class="rounded-xl bg-slate-100 px-4 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-200">
													{{ 'match_comment.modal.cancel'|trans }}
												</button>

												<button type="submit" class="rounded-xl bg-emerald-600 px-4 py-2.5 text-sm font-semibold text-white
																																																								                   hover:bg-emerald-700 focus:outline-none focus:ring-4 focus:ring-emerald-600/20">
													{{ 'match_comment.modal.save'|trans }}
												</button>
											</div>
										</form>

									</div>
								</div>
							</div>
						{% endif %}

					{% endfor %}

					{#{% if pages > 1 %}
																				  <nav class="mt-8 w-screen flex items-center justify-center" aria-label="Pagination des commentaires">
																				    <ul class="inline-flex mb-6 items-center gap-2 text-sm">
																				
																				   
																				      <li>
																				      
   <a
																				          href="{{ path('app_matchs_comm', { competitionId: competitionId, page: page > 1 ?
 page - 1 : 1 }) }}"
																				          class="inline-flex items-center justify-center gap-2 rounded-xl px-4 h-10 font-semibold
																				                 ring-1 ring-black/10 backdrop-blur
																				                 {{ page <= 1
																				                    ?
 'pointer-events-none opacity-40 bg-white/60 text-slate-700'
																				                    : 'bg-white/80 text-slate-800 hover:bg-white hover:text-slate-900' }}"
																				        >
																				          <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
																				            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
																				          </svg>
																				          Précédent
																				      
   </a>
																				      </li>
																				
																				     
																				      {% set start = page - 2 %}
																				      {% set end = page + 2 %}
																				
																				      {% if start < 1 %}
																				        {% set end = end + (1 - start) %}
																				        {% set start = 1 %}
																				      {% endif %}
																				      {% if end > pages %}
																				 
        {% set start = start - (end - pages) %}
																				        {% set end = pages %}
																				      {% endif %}
																				      {% if start < 1 %}{% set start = 1 %}{% endif %}
																				
																				      {# Première page #}
					{#}      {% if start > 1 %}
																				        <li>
																				          <a
																				       
      href="{{ path('app_matchs_comm', { competitionId: competitionId, page: 1 }) }}"
																				            class="inline-flex items-center justify-center w-10 h-10 rounded-xl font-semibold
																				                   bg-white/70 text-slate-800 ring-1 ring-black/10 hover:bg-white"
																				          >1</a>
																				        </li>
																				        {% if start > 2 %}
																				          <li class="px-1 text-slate-700/70 select-none">…</li>
																				  
       {% endif %}
																				      {% endif %}
																				
																				      {% for p in start..end %}
																				        <li>
																				          <a
																				            href="{{ path('app_matchs_comm', { competitionId: competitionId, page: p }) }}"
																				            class="inline-flex items-center justify-center w-10 h-10 rounded-xl font-semibold ring-1 ring-black/10 transition
																				              
      {{ p == page
																				                      ?
 'bg-emerald-600 text-white ring-emerald-600/30 shadow-sm'
																				                      : 'bg-white/70 text-slate-800 hover:bg-white' }}"
																				          >
																				            {{ p }}
																				          </a>
																				        </li>
																				      {% endfor %}
																				
																				    
																				      {% if end < pages %}
																				      
   {% if end < pages - 1 %}
																				          <li class="px-1 text-slate-700/70 select-none">…</li>
																				        {% endif %}
																				        <li>
																				          <a
																				            href="{{ path('app_matchs_comm', { competitionId: competitionId, page: pages }) }}"
																				            class="inline-flex items-center justify-center w-10 h-10 rounded-xl font-semibold
																				            
        bg-white/70 text-slate-800 ring-1 ring-black/10 hover:bg-white"
																				          >{{ pages }}</a>
																				        </li>
																				      {% endif %}
																				
																				      <li>
																				        <a
																				          href="{{ path('app_matchs_comm', { competitionId: competitionId, page: page < pages ?
 page + 1 : pages }) }}"
																				          class="inline-flex items-center justify-center gap-2 rounded-xl px-4 h-10 font-semibold
																				                 ring-1 ring-black/10 backdrop-blur
																				                 {{ page >= pages
																				                    ?
 'pointer-events-none opacity-40 bg-white/60 text-slate-700'
																				                    : 'bg-white/80 text-slate-800 hover:bg-white hover:text-slate-900' }}"
																				        >
																				          Suivant
																				          <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
																				            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
																				          </svg>
																				     
    </a>
																				      </li>
																				
																				    </ul>
																				  </nav>
																				{% endif %}#}


				</div>
			{% else %}

				<div class="flex justify-center px-4 py-16">
					<div class="max-w-md w-full rounded-2xl bg-white/85 p-8 text-center shadow-lg ring-1 ring-black/5 backdrop-blur">
						<p class="text-lg font-semibold text-slate-900">
							{{ 'match_comment.error.access_denied_title'|trans }}
						</p>
						<p class="mt-2 text-sm text-slate-600">
							{{ 'match_comment.error.access_denied_subtitle'|trans }}
 </p>
					</div>
				</div>

			{% endif %}
		{% endblock %}